{% extends "pages/layouts/_base.html" %}
{% load static %}

{% block title %}Encuestas - AIT{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<div class="container mt-3">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'home' %}">Inicio</a></li>
            <li class="breadcrumb-item active" aria-current="page">Encuestas</li>
        </ol>
    </nav>
</div>

    <div class="container" style="padding: 1rem 0 5rem 0;">
        <div class="row mb-5">
            <div class="col-12">
                <div class="text-center">
                    <h1 class="display-4 fw-bold mb-3" style="color: #184da1;">Encuestas Disponibles</h1>
                    <p class="lead text-muted">Participa en nuestras encuestas y ay√∫danos a mejorar</p>
                </div>
            </div>
        </div>
        
        <!-- Contenedor React para lista mejorada -->
        <div id="poll-list-react"></div>
        
        <!-- Datos para React (ocultos) -->
        <script type="application/json" id="poll-data">
            [
                {% for poll in polls %}
                {
                    "id": {{ poll.id }},
                    "title": "{{ poll.title|escapejs }}",
                    "description": "{{ poll.description|escapejs }}",
                    "star_date": "{{ poll.star_date|date:'c' }}",
                    "questions_count": {{ poll.preguntas.count }},
                    "image": {% if poll.image %}"{{ poll.image.url }}"{% else %}null{% endif %}
                }{% if not forloop.last %},{% endif %}
                {% endfor %}
            ]
        </script>
    </div>
    
    <!-- Componente React para Poll List -->
    <script type="text/babel" src="{% static 'js/react/PollListEnhanced.js' %}"></script>
    <script type="text/babel">
        // Obtener datos de Django
        const pollData = JSON.parse(document.getElementById('poll-data').textContent);
        
        // Renderizar componente React
        const pollListRoot = ReactDOM.createRoot(document.getElementById('poll-list-react'));
        pollListRoot.render(<PollListEnhanced initialPolls={pollData} />);
    </script>
{% endblock %}